#!cd $dir && /usr/bin/dyalogscript $fileName
rlDir ← '../link/',⍨⊃1⎕NPARTS''
rl ← 0⎕Fix rlDir,'raylib.apln'
rl.Init rlDir

rl.InitWindow 800 800 'Music Test'

rl.InitAudioDevice⍬

⍝ Load music
musicPath ← 'assets/piano-loop.mp3'
music ← rl.LoadMusicStream musicPath

⍝ Play the music
rl.PlayMusicStream music

⍝ Set volume to 50%
rl.SetMusicVolume music 0.75

:While ~rl.WindowShouldClose⍬
    ⍝ Update music stream (required for music to play)
    rl.UpdateMusicStream music
    
    ⍝ Check for spacebar press to pause/resume
    :If rl.IsKeyPressed rl.KeyboardKey.KEY_SPACE
        :If rl.IsMusicStreamPlaying music
            rl.PauseMusicStream music        
        :Else
            rl.ResumeMusicStream music
       :EndIf
    :EndIf
    
    rl.BeginDrawing⍬
        rl.ClearBackground rl.color.gray
        
        ⍝ Display instructions
        rl.DrawText 'Music Test - Piano Loop' 10 10 20 rl.color.white
        rl.DrawText 'Press SPACE to pause/resume' 10 40 16 rl.color.lightgray
        
        ⍝ Show music status
        status ← ('Paused' 'Playing')[1+rl.IsMusicStreamPlaying music]
        rl.DrawText (∊'Status: ',status) 10 70 16 (⊃((⊂rl.color.red),(⊂rl.color.green))[1+rl.IsMusicStreamPlaying music])
        
    rl.EndDrawing⍬
:EndWhile

⍝ Clean up
rl.StopMusicStream music
rl.UnloadMusicStream music
rl.CloseAudioDevice⍬
rl.CloseWindow⍬
